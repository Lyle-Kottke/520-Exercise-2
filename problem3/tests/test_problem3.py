import io
import importlib
import pytest
import signal

import sys, os
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))


#load the benchmark data
input_output={  "inputs": [    "5 7500 South 10000 East 3500 North 4444 West 4000 North ",    "2 15000 South 4000 East ",    "5 20000 South 1000 North 1000000 West 9000 North 10000 North ",    "3 20000 South 10 East 20000 North ",    "2 1000 North 1000 South ",    "4 50 South 50 North 15000 South 15000 North ",    "1 1 South ",    "1 1 East ",    "2 1000000 South 1000000 North ",    "1 149 South ",    "1 16277 East ",    "1 19701 South ",    "1 3125 South ",    "1 6549 South ",    "1 2677 South ",    "1 6101 South ",    "1 9525 South ",    "1 5653 South ",    "2 15072 South 15072 North ",    "2 11200 South 11200 North ",    "2 14624 South 14624 North ",    "2 18048 South 15452 West ",    "2 1472 West 4930 North ",    "2 17600 South 17600 North ",    "2 8320 East 16589 East ",    "2 4448 South 4448 North ",    
"2 576 South 576 North ",    "3 14186 South 2291 West 14186 North ",    "3 10314 South 15961 North 5647 South ",    "3 1035 East 18143 South 18143 North ",  
  "3 17163 South 7620 East 17163 North ",    "3 587 South 17098 North 16511 South ",    "3 16715 North 6576 West 12132 South ",    "3 7435 South 245 North 7190 North ",    "3 3563 South 2427 South 5990 North ",    "3 6987 South 11904 East 19951 East ",    "4 13301 South 5948 East 9265 East 6891 North ",    "4 16725 South 8129 South 19530 West 24854 North ",    "4 149 South 17607 West 18306 South 18455 North ",    "4 16277 South 19789 North 4379 South 867 North ",    "4 19701 South 13458 South 3156 North 30003 North ",    "4 3125 South 15640 East 6125 East 19535 South ",    "4 6549 East 5118 North 12198 East 5118 South ",    "4 2677 East 1891 West 10974 West 7511 North ",    "4 6102 South 8265 East 13943 South 20045 North ",    "5 12416 South 18116 North 10553 West 18435 West 5700 South ",    "5 15840 South 7594 South 13522 South 2423 South 3334 West ",    "5 19264 East 13968 East 19595 North 19115 North 38710 South ",    "5 15392 South 3445 North 18372 East 10399 North 4403 South ",    "5 18816 South 5627 West 14045 East 7091 East 18816 North ",    "5 2240 South 15104 North 118 West 11079 East 12864 South ",    "5 5664 South 1478 South 18894 South 2363 West 26036 North ",    "5 1792 South 10956 East 9159 South 19055 West 10951 North ",    "5 12512 South 13137 North 7936 North 7235 South 1326 South ",    "6 14635 North 14477 South 17250 North 14170 East 15166 South 2242 South ",    "6 10763 North 3954 West 7515 North 18158 West 6644 South 11634 South ",    "6 14187 South 13432 North 6292 East 14850 West 10827 South 9639 East ",    "6 10315 South 15614 South 5069 West 6134 South 7713 North 24350 North ",    "6 1035 South 9283 East 15333 South 2826 South 19191 North 3 North ",    "6 17163 West 11465 North 14110 South 6814 North 3373 East 4169 South ",    "6 587 South 942 West 183 North 18098 North 260 East 17694 South ",    "6 16715 West 3124 East 3152 East 14790 East 11738 West 11461 East ",    "6 7435 South 12602 South 1929 East 6074 East 15920 West 20037 North ",    "7 13750 South 6645 South 18539 East 5713 North 1580 North 10012 West 13102 North ",    "7 9878 West 8827 East 1508 West 9702 North 5763 North 9755 North 10034 South ",    "7 13302 West 2496 North 284 West 6394 East 9945 North 12603 West 12275 North ",    "7 16726 East 19270 West 6357 South 17678 East 14127 East 12347 South 6005 East ",    "7 150 South 1452 North 9326 North 1666 West 18309 East 19386 East 8246 West ",    "7 16278 South 10929 South 8103 East 18358 West 2492 West 11834 South 39041 North ",    "7 19702 South 13111 East 6880 East 9642 South 6674 West 18874 East 1112 North ",    "7 3126 South 6780 North 9848 West 6334 North 10856 West 14425 West 10649 East ",    "7 6550 South 8962 West 15921 South 17618 North 15038 South 1465 North 18426 North ",    "8 12864 South 3005 West 16723 West 17257 West 12187 East 12976 South 1598 North 24242 North ",    "8 8992 South 12483 North 15500 South 1245 South 9073 East 12719 East 3839 East 7130 South ",    "8 12416 North 14665 South 14277 North 2129 South 13255 East 19759 South 10272 West 9860 North ",    "8 15840 South 4142 East 17246 North 13413 North 4733 West 15311 North 12514 South 17616 South ",    "8 19264 South 10516 North 3319 East 17401 East 1620 West 2350 West 6243 North 2505 North ",    "8 15392 South 7290 West 2096 West 14093 East 5802 South 2094 North 8484 East 19100 North ",    "8 6113 South 16767 East 5064 South 5377 West 17280 South 1838 West 2213 West 28457 North ",    "8 2241 West 18949 South 11137 South 2069 West 14166 South 1581 South 4455 South 50288 North ",    "8 5665 South 8426 East 9914 North 13353 South 18349 North 4429 East 18184 North 27429 South ",    "9 11979 South 2470 East 10716 North 12992 East 15497 West 15940 North 8107 West 18934 East 6993 South ",    "9 8107 South 4652 North 9493 North 16980 West 12383 West 2980 West 17644 South 11043 West 11447 North ",    "9 18827 South 18321 West 8270 East 968 West 16565 West 15427 North 4077 North 18960 North 19006 West ",    "9 14955 West 503 North 18535 West 4956 South 8044 South 2467 East 13615 East 6877 East 3460 North ",    "9 18379 South 9980 South 17311 West 8944 South 4930 South 18019 South 48 West 14794 South 75046 North ",    "9 14507 East 12162 East 16088 South 5636 North 9112 North 5058 East 9585 South 2712 East 10925 North ",    "9 5227 East 8936 North 6353 North 16920 North 591 North 4802 South 8722 North 3333 West 36720 South ",    "9 1355 North 15309 West 17834 North 13612 East 17477 North 4546 North 18260 East 15442 North 56654 South ",    "9 4779 South 4787 East 3907 East 4896 East 1659 East 4289 West 4693 West 3359 East 4779 North ",    "1 80000 South ",    "2 40000 South 20000 North ",    "1 40000 South ",    "2 20001 South 20001 North ",    "4 10000 South 20000 South 10000 North 20000 North ",    "3 10 South 20 North 10 North ",    "3 1000 South 1001 North 1 North ",    "2 20000 South 20000 West ",    "3 10000 South 20000 South 10000 North ",    "2 1 East 1 North ",    "2 20000 West 20000 West ",    "2 80000 South 20000 North ",    "2 19999 South 20001 South ",    "3 500 South 1000 North 500 North ",    "1 400000 South ",    "2 40000 South 80000 North ",    "2 100 West 100 North ",    "2 40000 South 40000 North ",    "2 30000 South 10000 North ",    "2 20000 South 40000 North ",    "10 20000 South 20000 North 20000 South 20000 North 20000 South 20000 North 20000 South 20000 North 20000 South 20000 North ",    "2 40001 South 40001 North ",    "2 40001 South 1 North ",    "2 50000 South 50000 North ",    "2 30000 South 30000 South ",    "2 10000 South 50000 North ",    "4 15000 South 15000 South 15000 North 15000 North ",    "3 50 South 100 North 50 North ",    "2 20001 South 1 North ",    "3 5 South 6 North 1 South ",    "1 20000 South ",    "4 1 South 20000 South 1 North 20000 North ",    "2 30000 South 30000 North ",    "3 1 South 2 North 1 South ",    "2 60000 South 60000 North ",    "2 50000 South 10000 North ",    "1 5 North ",    "2 20010 South 19990 North ",    "3 20000 South 1 South 20000 North ",    "3 1 South 2 North 39999 North ",    "3 10 South 20 North 10 South ",    "3 1 South 2 North 1 North ",    "3 2000 South 19000 South 19000 South ",    "6 15000 South 15000 South 15000 South 15000 North 15000 North 15000 North ",    "3 1 South 1 North 1 East ",    "2 1 West 1 North ",    "3 1 South 123456 West 1 North "  ],  
  "outputs": [    "YES ",    "NO ",    "YES ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "YES ",    "YES ",    "YES ",    "NO ",    "NO ",    "YES ",    "NO ",    "YES ",    "YES ",    "YES ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "YES ",    "YES ",    "NO ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    
"NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",  
  "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "YES ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "NO ",    "YES "  ]}

#test functions
def parse_direction_string(s: str):
    parts = s.strip().split()
    first_number = int(parts[0])
    pairs = []

    for i in range(1, len(parts), 2):
        if i + 1 >= len(parts):
            break
        num = int(parts[i])
        direction = parts[i + 1]
        pairs.append((num, direction))

    return (first_number, pairs)

@pytest.mark.parametrize("input_str,expected_output", zip(input_output["inputs"], input_output["outputs"]))
def test_problem_dynamic(monkeypatch, capsys, input_str, expected_output):
    
    def test(solution):
      parsed_args = parse_direction_string(input_str)

      sol = solution.solve(*parsed_args)

      result = str(expected_output)
      result = result.replace(" ", "")
      assert sol == result

    test(importlib.import_module("solutions.solution1"))
    test(importlib.import_module("solutions.solution2"))
    test(importlib.import_module("solutions.solution3"))
    test(importlib.import_module("solutions.solution4"))